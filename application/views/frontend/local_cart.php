<br />
<br />
<br />
<br />
<br />
<br />
<style media="screen">
            .form11 {

            margin-left: 40px ;
            text-align: center;
            padding-top: 0px;
            }

            .value-button {
            display: inline-block;
            border: 1px solid #ddd;
            margin: 0px;
            width: 40px;
            height: 40px;
            text-align: center;
            vertical-align: middle;
            padding: 11px 0;
            background: #e66b47;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            }

            .value-button:hover {
            cursor: pointer;
            }

            .form11 #decrease {
            margin-right: -4px;
            border-radius: 8px 0 0 8px;
            }

            .form11 #increase {
            margin-left: -4px;
            border-radius: 0 8px 8px 0;
            }

            form #input-wrap {
            margin: 0px;
            padding: 0px;
            }

            input.qty {
            text-align: center;
            border: 1px solid #ddd;
            margin: 0px;
            width: 32px;
            height: 32px;
            }

            input[type=number]::-webkit-inner-spin-button,
            input[type=number]::-webkit-outer-spin-button {
              -webkit-appearance: none;
              margin: 0;
            }
            @media (max-width :896px)
            {
            .form11{margin-left: 0px!important;}


            }
.ul_st2{
font-size: 18px;
}
.li_st2{
  line-height: 3rem;
}
</style>
<style>
.chk{
background: #d76a46;
color: white;
border: none;
width:100%;
}
.chk:hover{
  background: black;
  color: white;
}
.ctr{
  text-align: start;
}
</style>

<style media="screen">
  /*! CSS Used from: https://www.orangetree.in/pub/static/version1642005426/_cache/merged/d81b0b1b78cf9f17bee2b1ad28a7321e.min.css ; media=all */
  @media all {
    a {
      color: #1979c3;
      text-decoration: none;
    }

    a:visited {
      color: #1979c3;
      text-decoration: none;
    }

    a:hover {
      color: #006bb4;
      text-decoration: underline;
    }

    a:active {
      color: #ff5501;
      text-decoration: underline;
    }

    input[type=number]:disabled {
      opacity: .5;
    }

    input[type=number]::-moz-placeholder {
      color: #c2c2c2;
    }

    input[type=number]::-webkit-input-placeholder {
      color: #c2c2c2;
    }

    input[type=number]:-ms-input-placeholder {
      color: #c2c2c2;
    }

    input[type=number] {
      -moz-appearance: textfield;
    }

    input::-moz-focus-inner {
      border: 0;
      padding: 0;
    }

    *:focus {
      box-shadow: none;
      outline: 0;
    }

    input:not([disabled]):focus {
      box-shadow: 0 0 3px 1px #68a8e0;
    }

    *,
    ::after,
    ::before {
      box-sizing: border-box;
    }

    a {
      color: #007bff;
      text-decoration: none;
      background-color: transparent;
    }

    a:hover {
      color: #0056b3;
      text-decoration: underline;
    }

    input {
      margin: 0;
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }

    input {
      overflow: visible;
    }

    .input-group {
      position: relative;
      display: -ms-flexbox;
      display: flex;
      -ms-flex-wrap: wrap;
      flex-wrap: wrap;
      -ms-flex-align: stretch;
      align-items: stretch;
      width: 100%;
    }

    @media print {

      *,
      ::after,
      ::before {
        text-shadow: none !important;
        box-shadow: none !important;
      }

      a:not(.btn) {
        text-decoration: underline;
      }
    }

    a:hover,
    a:focus {
      text-decoration: none;
    }

    a {
      color: #006bb4;
      text-decoration: none;
    }

    a:hover,
    a:focus {
      text-decoration: none !important;
    }

    ::-webkit-scrollbar {
      display: none;
    }



    div#custom-qty .input-group input#qty {
      pointer-events: none;
    }

    div#error-response {
      text-align: center;
      left: 0;
      position: absolute;
      z-index: 3;
      font-size: 14px;
      background: #f1f1f1;
      width: 280px;
      padding: 20px;
      box-shadow: 0px 0px 5px 1px #c9c9c9;
      border-radius: 20px;
      top: 42px;
    }

    div#custom-qty {
      position: relative;
    }

    div#error-response a {
      color: #e66b47;
    }

    input:not([disabled]):focus {
      box-shadow: none !important;
    }

    input:not([disabled]):focus {
      box-shadow: none;
    }

    div#custom-qty {
      display: block;
      margin-bottom: 0;
    }

    div#custom-qty .input-group {
      display: flex;
      align-items: center;
    }

    div#custom-qty .input-group span.input-group__addon {
      display: inline-block;
      width: 40px;
      text-align: center;
      padding: 7px 0;
      border: 1px solid #ccc;
      cursor: pointer;
      height: 32px;
      font-size: 15px;
      line-height: 1;
    }

    div#custom-qty .input-group input#qty {
      display: inline-block;
      width: 50px;
      text-align: center;
    }

    div#custom-qty .input-group span.input-group__addon:first-child {
      border-right: 0;
      border-top-left-radius: 20px;
      border-bottom-left-radius: 20px;
    }

    div#custom-qty .input-group span.input-group__addon:last-child {
      border-left: 0;
      border-top-right-radius: 20px;
      border-bottom-right-radius: 20px;
    }
  }

  /*! CSS Used from: https://www.orangetree.in/pub/static/version1642005426/frontend/Digital/desktop/en_US/css/print.min.css ; media=print */
  @media print {
    @media print {
      * {
        -webkit-filter: none !important;
        background: 0 0 !important;
        color: #000 !important;
        filter: none !important;
        text-shadow: none !important;
      }

      a,
      a:visited {
        text-decoration: underline !important;
      }
    }
  }
</style>
<section>
<div class="container" style="font-weight:700;" id="here">
<div class="row">
<div class="col-md-8">
<h2>Your Shopping Bag</h2>
<br />
<?if (empty($this->session->userdata('cart_data'))) {?>
<h4>Your cart is empty! Please add some product</h4>
<?} else {
$cartdata= $this->session->userdata('cart_data');
$total=0;
$i=1;
foreach ($cartdata as $cart) {
$this->db->select('*');
$this->db->from('tbl_products');
$this->db->where('id', $cart['product_id']);
$pro_data= $this->db->get()->row(); ?>
<div class="row mt-2" style="border:1px solid #ccc;">

 <div class="col-md-4 col-4 pimg p-3" >
 <img src="<?=base_url().$pro_data->image?>" >
 </div>
 <div class="col-md-8 col-8 p-3 " >
   <a href="javascript:void(0);" onclick="deleteCartOffline(this)" product_id="<?=base64_encode($cart['product_id'])?>"><span class="float-right positn" style="font-size:30px;  color:#d76a46">&times</span></a>
   <ul class="ul_st2">
     <li class="li_st2"><span><?=$pro_data->productname?></span></li>
     <li class="li_st2" style="display:flex"><span>Qty:&nbsp;</span>
       <div id="custom-qty" class="control ml-4 mt-2">
         <!-- ko template: getTemplate() -->
         <div class="input-group">
           <span class="input-group__addon">
             <div class="input-group__button input-group__button--decrease" id="decrease" onclick="decreaseValue('<?=$i?>')">
               <span class="input-group__icon input-group__icon--decrease">-</span>
             </div>
           </span>
           <input type="number" readonly style="color:black" name="qty" class="qty" id="number_<?=$i?>" min="1" value="<?=$cart['quantity']?>" maxlength="12" class="input-group__input"
          i="<?=$i?>" product_id="<?=base64_encode($cart['product_id'])?>" mrp="<?=$pro_data->selling_price?>"
           >
           <span class="input-group__addon">
             <div class="input-group__button input-group__button--increase" id="increase" onclick="increaseValue('<?=$i?>')">
               <span class="input-group__icon input-group__icon--increase">+</span>
             </div>
           </span>
         </div>
         <!-- /ko -->
       </div>
     </li>
     <li class="li_st"><span id="price_<?=$i?>">Price:&nbsp;£<?=$mrp = $pro_data->selling_price*$cart['quantity']?></span></li>
   </ul>
  </div>
</div>
<?$total = $total + $mrp;
$i++;
}
}?>
</div>
<div class="col-md-4 mt-3" style="position:sticky;">
<h4><b>Order Summary</b></h4>
<hr />
<p class="subtotal ctr">Cart Total <span class="float-right" id="subtotal">£<?if (empty($this->session->userdata('cart_data'))) {
echo 0;
} else {
echo $total;
}?></span></p>
  <div class="w-100">
    <button class="chk" id="hjki">
      Checkout
    </button>
      <label class="ml-5" style="color:red;font-size: 13px;">Please login/Register for checkout</label>
  </div>
</div>
</div>
</div>
</section>
<br />
<br />
<br />
<br />
<br />
<br />
<script>


function increaseValue(i) {
  var value = parseInt(document.getElementById('number_'+i).value, 10);
  value = isNaN(value) ? 0 : value;
  value++;
  document.getElementById('number_'+i).value = value;
  document.getElementById('number_'+i).setAttribute('value', value);
 updateCartOffline(i);
}

function decreaseValue(i) {
  var value = parseInt(document.getElementById('number_'+i).value, 10);
  if(value==1){
    document.getElementById('number_'+i).value = value;
    return;
  }
  value = isNaN(value) ? 0 : value;
  value < 1 ? value = 1 : '';
  value--;
  document.getElementById('number_'+i).value = value;
  document.getElementById('number_'+i).setAttribute('value', value);
   updateCartOffline(i);

}




  function deleteCartOffline(obj) {
    var product_id = $(obj).attr("product_id");
    // alert(product_id);
    var base_path = "<?=base_url();?>";
    $.ajax({
      url: '<?=base_url();?>Cart/deleteCartOffline',
      method: 'post',
      data: {
        product_id: product_id
      },
      dataType: 'json',
      success: function(response) {
        // alert(response)
        if (response.data == true) {
          $.notify({
            icon: 'fa fa-check',
            title: '',
            message: response.data_message
          }, {
            element: 'body',
            position: null,
            type: "success",
            allow_dismiss: true,
            newest_on_top: false,
            showProgressbar: false,
            placement: {
              from: "top",
              align: "right"
            },
            offset: 20,
            spacing: 10,
            z_index: 1031,
            delay: 1000,
            animate: {
              enter: 'animated fadeInDown',
              exit: 'animated fadeOutUp'
            },
            icon_type: 'class',
            template: '<div data-notify="container" class="col-xs-11 col-sm-3 alert alert-{0}" role="alert">' +
              '<button type="button" aria-hidden="true" class="close" data-notify="dismiss">×</button>' +
              '<span data-notify="icon"></span> ' +
              '<span data-notify="title">{1}</span> ' +
              '<span data-notify="message">{2}</span>' +
              '<a href="{3}" target="{4}" data-notify="url"></a>' +
              '</div>'
          });

           $( "#here" ).load(window.location.href + " #here > *" );
           $( "#count" ).load(window.location.href + " #count > *" );
           $( "#mySidebar" ).load(window.location.href + " #mySidebar > *" );



        } else if (response.data == false) {
          $.notify({
            icon: 'fa fa-cancel',
            title: '',
            message: response.data_message
          }, {
            element: 'body',
            position: null,
            type: "danger",
            allow_dismiss: true,
            newest_on_top: false,
            showProgressbar: true,
            placement: {
              from: "top",
              align: "right"
            },
            offset: 20,
            spacing: 10,
            z_index: 1031,
            delay: 5000,
            animate: {
              enter: 'animated fadeInDown',
              exit: 'animated fadeOutUp'
            },
            icon_type: 'class',
            template: '<div data-notify="container" class="col-xs-11 col-sm-3 alert alert-{0}" role="alert">' +
              '<button type="button" aria-hidden="true" class="close" data-notify="dismiss">×</button>' +
              '<span data-notify="icon"></span> ' +
              '<span data-notify="title">{1}</span> ' +
              '<span data-notify="message">{2}</span>' +
              '<a href="{3}" target="{4}" data-notify="url"></a>' +
              '</div>'
          });
          $( "#here" ).load(window.location.href + " #here > *" );
          $( "#count" ).load(window.location.href + " #count > *" );
          $( "#mySidebar" ).load(window.location.href + " #mySidebar > *" );


        }
      }
    });
  }

  function updateCartOffline(i) {
    var product_id = $("#number_"+i).attr("product_id");
    var mrp = $("#number_"+i).attr("mrp");
    var qty = $("#number_"+i).val();
    if(qty==0){
      window.location.reload();
      return;

    }
    var price = parseInt(mrp) * parseInt(qty);
    var base_path = "<?=base_url();?>";
    $.ajax({
      url: '<?=base_url();?>Cart/updateCartOffline',
      method: 'post',
      data: {
        product_id: product_id,
        quantity: qty
      },
      dataType: 'json',
      success: function(response) {
        // alert(response)
        if (response.data == true) {
          document.getElementById('price_' + i).innerHTML = "Price:&nbsp;£"+price;
          document.getElementById('subtotal').innerHTML = "£"+response.data_price;
          document.getElementById('total_cost').innerHTML = "£"+response.data_subtotal;
          $.notify({
            icon: 'fa fa-check',
            title: 'Alert!',
            message: response.data_message
          }, {
            element: 'body',
            position: null,
            type: "success",
            allow_dismiss: true,
            newest_on_top: false,
            showProgressbar: true,
            placement: {
              from: "top",
              align: "right"
            },
            offset: 20,
            spacing: 10,
            z_index: 1031,
            delay: 5000,
            animate: {
              enter: 'animated fadeInDown',
              exit: 'animated fadeOutUp'
            },
            icon_type: 'class',
            template: '<div data-notify="container" class="col-xs-11 col-sm-3 alert alert-{0}" role="alert">' +
              '<button type="button" aria-hidden="true" class="close" data-notify="dismiss">×</button>' +
              '<span data-notify="icon"></span> ' +
              '<span data-notify="title">{1}</span> ' +
              '<span data-notify="message">{2}</span>' +
              // '<div class="progress" data-notify="progressbar">' +
              // '<div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>' +
              // '</div>' +
              '<a href="{3}" target="{4}" data-notify="url"></a>' +
              '</div>'
          });
          $( "#here" ).load(window.location.href + " #here > *" );
          $( "#mySidebar" ).load(window.location.href + " #mySidebar > *" );


          // $('#price_'+i).html(price);
        } else if (response.data == false) {
          $.notify({
            icon: 'fa fa-cancel',
            title: 'Alert!',
            message: response.data_message
          }, {
            element: 'body',
            position: null,
            type: "danger",
            allow_dismiss: true,
            newest_on_top: false,
            showProgressbar: true,
            placement: {
              from: "top",
              align: "right"
            },
            offset: 20,
            spacing: 10,
            z_index: 1031,
            delay: 5000,
            animate: {
              enter: 'animated fadeInDown',
              exit: 'animated fadeOutUp'
            },
            icon_type: 'class',
            template: '<div data-notify="container" class="col-xs-11 col-sm-3 alert alert-{0}" role="alert">' +
              '<button type="button" aria-hidden="true" class="close" data-notify="dismiss">×</button>' +
              '<span data-notify="icon"></span> ' +
              '<span data-notify="title">{1}</span> ' +
              '<span data-notify="message">{2}</span>' +
              // '<div class="progress" data-notify="progressbar">' +
              // '<div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>' +
              // '</div>' +
              '<a href="{3}" target="{4}" data-notify="url"></a>' +
              '</div>'
          });
          $( "#here" ).load(window.location.href + " #here > *" );
          $( "#mySidebar" ).load(window.location.href + " #mySidebar > *" );


        }
      }
    });
  }
</script>
